{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/adityakumarsingh135/melting-point-prediction?scriptVersionId=274527298\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"cd189cb2","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2025-11-08T14:02:47.002597Z","iopub.status.busy":"2025-11-08T14:02:47.002356Z","iopub.status.idle":"2025-11-08T14:02:48.363538Z","shell.execute_reply":"2025-11-08T14:02:48.362781Z"},"papermill":{"duration":1.369169,"end_time":"2025-11-08T14:02:48.364955","exception":false,"start_time":"2025-11-08T14:02:46.995786","status":"completed"},"tags":[]},"outputs":[],"source":["# This Python 3 environment comes with many helpful analytics libraries installed\n","# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n","# For example, here's several helpful packages to load\n","\n","import numpy as np # linear algebra\n","import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n","\n","# Input data files are available in the read-only \"../input/\" directory\n","# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n","\n","import os\n","# for dirname, _, filenames in os.walk('/kaggle/input'):\n","#     for filename in filenames:\n","#         print(os.path.join(dirname, filename))\n","\n","# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n","# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"]},{"cell_type":"markdown","id":"13350fdf","metadata":{"papermill":{"duration":0.004877,"end_time":"2025-11-08T14:02:48.375554","exception":false,"start_time":"2025-11-08T14:02:48.370677","status":"completed"},"tags":[]},"source":["RDkit is an open source cheminformatics library - basically a toolkit that helps scientists and devloper work with chemical structures using code "]},{"cell_type":"code","execution_count":2,"id":"f9d39ae1","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:02:48.386248Z","iopub.status.busy":"2025-11-08T14:02:48.385967Z","iopub.status.idle":"2025-11-08T14:02:54.392584Z","shell.execute_reply":"2025-11-08T14:02:54.391804Z"},"papermill":{"duration":6.013343,"end_time":"2025-11-08T14:02:54.394039","exception":false,"start_time":"2025-11-08T14:02:48.380696","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting rdkit\r\n","  Downloading rdkit-2025.9.1-cp311-cp311-manylinux_2_28_x86_64.whl.metadata (4.1 kB)\r\n","Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from rdkit) (1.26.4)\r\n","Requirement already satisfied: Pillow in /usr/local/lib/python3.11/dist-packages (from rdkit) (11.3.0)\r\n","Requirement already satisfied: mkl_fft in /usr/local/lib/python3.11/dist-packages (from numpy->rdkit) (1.3.8)\r\n","Requirement already satisfied: mkl_random in /usr/local/lib/python3.11/dist-packages (from numpy->rdkit) (1.2.4)\r\n","Requirement already satisfied: mkl_umath in /usr/local/lib/python3.11/dist-packages (from numpy->rdkit) (0.1.1)\r\n","Requirement already satisfied: mkl in /usr/local/lib/python3.11/dist-packages (from numpy->rdkit) (2025.2.0)\r\n","Requirement already satisfied: tbb4py in /usr/local/lib/python3.11/dist-packages (from numpy->rdkit) (2022.2.0)\r\n","Requirement already satisfied: mkl-service in /usr/local/lib/python3.11/dist-packages (from numpy->rdkit) (2.4.1)\r\n","Requirement already satisfied: intel-openmp<2026,>=2024 in /usr/local/lib/python3.11/dist-packages (from mkl->numpy->rdkit) (2024.2.0)\r\n","Requirement already satisfied: tbb==2022.* in /usr/local/lib/python3.11/dist-packages (from mkl->numpy->rdkit) (2022.2.0)\r\n","Requirement already satisfied: tcmlib==1.* in /usr/local/lib/python3.11/dist-packages (from tbb==2022.*->mkl->numpy->rdkit) (1.4.0)\r\n","Requirement already satisfied: intel-cmplr-lib-rt in /usr/local/lib/python3.11/dist-packages (from mkl_umath->numpy->rdkit) (2024.2.0)\r\n","Requirement already satisfied: intel-cmplr-lib-ur==2024.2.0 in /usr/local/lib/python3.11/dist-packages (from intel-openmp<2026,>=2024->mkl->numpy->rdkit) (2024.2.0)\r\n","Downloading rdkit-2025.9.1-cp311-cp311-manylinux_2_28_x86_64.whl (36.2 MB)\r\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m36.2/36.2 MB\u001b[0m \u001b[31m49.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n","\u001b[?25hInstalling collected packages: rdkit\r\n","Successfully installed rdkit-2025.9.1\r\n"]}],"source":["!pip install rdkit "]},{"cell_type":"code","execution_count":3,"id":"648684fa","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:02:54.407057Z","iopub.status.busy":"2025-11-08T14:02:54.406837Z","iopub.status.idle":"2025-11-08T14:02:58.251857Z","shell.execute_reply":"2025-11-08T14:02:58.251054Z"},"papermill":{"duration":3.853087,"end_time":"2025-11-08T14:02:58.253298","exception":false,"start_time":"2025-11-08T14:02:54.400211","status":"completed"},"tags":[]},"outputs":[],"source":["import shutil \n","import numpy as np \n","import pandas as pd \n","import seaborn as sns\n","import matplotlib.pyplot as plt \n","\n","import optuna \n","from sklearn.feature_selection import SelectFromModel\n","from sklearn.preprocessing import PowerTransformer # data transformation technique that makes your data more gaussian forma or normal form \n","# which often helps to imporve the accuracy \n","from sklearn.model_selection import KFold, cross_val_score, StratifiedKFold\n","from sklearn.metrics import mean_absolute_error, make_scorer, mean_squared_error\n","from rdkit import Chem\n","from rdkit.Chem import Descriptors, Crippen, rdMolDescriptors, MACCSkeys, RDKFingerprint, rdFingerprintGenerator \n","from rdkit.Chem.AtomPairs import Pairs, Torsions\n","\n","from rdkit import RDLogger\n","RDLogger.DisableLog('rdApp.*')\n","\n","try:\n","    from rdkit.Avalon import pyAvalonTools\n","    avalon_available = True\n","except ImportError:\n","    avalon_available = False\n","\n","import plotly.io as pio\n","pio.renderers.default = \"iframe_connected\"\n","\n","from IPython.display import clear_output\n","\n","import xgboost"]},{"cell_type":"markdown","id":"a3a0313a","metadata":{"papermill":{"duration":0.005277,"end_time":"2025-11-08T14:02:58.264409","exception":false,"start_time":"2025-11-08T14:02:58.259132","status":"completed"},"tags":[]},"source":["chem give you access to molecular representation mol=Chem.molFromSmiles(\"cco\") ethanol. descriptors functions to calculate the physiochemical properties of molecules. crippen-> computes crippen descriptors , mailyLogP(octanol-water partition coefficient) and molecular Refractivity(MR) . MACCSKeys-> generates maccskeys fingerprints : a classic type of binary molecular fingerprint (166but vector) each bit represnts the presence /absemce of a predefined substructers . rdmodeldescriptors-> a collection of high level of molecular descriptions including morgan Fingerprints, topological torsion fingerprints, atom pair fingerprints.rdmolops/rdkfingerprint-> rdkfingerprint i sthe original rdkit fingerprint algorithm "]},{"cell_type":"code","execution_count":4,"id":"c391dacc","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:02:58.276111Z","iopub.status.busy":"2025-11-08T14:02:58.275653Z","iopub.status.idle":"2025-11-08T14:03:01.997231Z","shell.execute_reply":"2025-11-08T14:03:01.996412Z"},"papermill":{"duration":3.728805,"end_time":"2025-11-08T14:03:01.99857","exception":false,"start_time":"2025-11-08T14:02:58.269765","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["((2662, 2), (666, 2), (28645, 9), (3041, 11))"]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["# loading the data \n","train = pd.read_csv('/kaggle/input/melting-point/train.csv') \n","test = pd.read_csv('/kaggle/input/melting-point/test.csv')\n","\n","bradley = pd.read_excel('/kaggle/input/melting-point-chemical-dataset/BradleyMeltingPointDataset.xlsx')\n","bradleyplus = pd.read_excel('/kaggle/input/melting-point-chemical-dataset/BradleyDoublePlusGoodMeltingPointDataset.xlsx')\n","\n","# hum log jo hamara competition ka data hai usme se compound and unka melting point rakh lenge and us particular compound\n","# se related features hum rdkit ke through extract karenge \n","train = train[['SMILES', 'Tm']]\n","test = test[['id', 'SMILES']]\n","\n","train.shape, test.shape, bradley.shape, bradleyplus.shape"]},{"cell_type":"code","execution_count":5,"id":"430bc24e","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:03:02.010942Z","iopub.status.busy":"2025-11-08T14:03:02.0106Z","iopub.status.idle":"2025-11-08T14:03:02.028697Z","shell.execute_reply":"2025-11-08T14:03:02.028069Z"},"papermill":{"duration":0.025611,"end_time":"2025-11-08T14:03:02.029835","exception":false,"start_time":"2025-11-08T14:03:02.004224","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>key</th>\n","      <th>name</th>\n","      <th>smiles</th>\n","      <th>mpC</th>\n","      <th>csid</th>\n","      <th>link</th>\n","      <th>source</th>\n","      <th>donotuse</th>\n","      <th>donotusebecause</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>2-(2,4-dinitrobenzyl)pyridine</td>\n","      <td>c1ccnc(c1)Cc2ccc(cc2[N+](=O)[O-])[N+](=O)[O-]</td>\n","      <td>92.0</td>\n","      <td>64018</td>\n","      <td>http://www.alfa.com/en/GP100W.pgm?DSSTK=B24192</td>\n","      <td>Alfa Aesar</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2-(1-piperidinyl)aniline</td>\n","      <td>c1ccc(c(c1)N)N2CCCCC2</td>\n","      <td>46.0</td>\n","      <td>403764</td>\n","      <td>http://www.alfa.com/en/GP100W.pgm?DSSTK=A13073</td>\n","      <td>Alfa Aesar</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>2-(1-piperazinyl)pyrimidine</td>\n","      <td>c1cnc(nc1)N2CCNCC2</td>\n","      <td>33.0</td>\n","      <td>80080</td>\n","      <td>http://www.alfa.com/en/GP100W.pgm?DSSTK=L15884</td>\n","      <td>Alfa Aesar</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2-(1-piperazinyl)phenol</td>\n","      <td>c1ccc(c(c1)N2CCNCC2)O</td>\n","      <td>125.0</td>\n","      <td>63701</td>\n","      <td>http://www.alfa.com/en/GP100W.pgm?DSSTK=B20252</td>\n","      <td>Alfa Aesar</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>2-(1-cyclohexenyl)ethylamine</td>\n","      <td>C1CCC(=CC1)CCN</td>\n","      <td>-55.0</td>\n","      <td>69388</td>\n","      <td>http://www.alfa.com/en/GP100W.pgm?DSSTK=L08261</td>\n","      <td>Alfa Aesar</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   key                           name  \\\n","0    1  2-(2,4-dinitrobenzyl)pyridine   \n","1    2       2-(1-piperidinyl)aniline   \n","2    3    2-(1-piperazinyl)pyrimidine   \n","3    4        2-(1-piperazinyl)phenol   \n","4    5   2-(1-cyclohexenyl)ethylamine   \n","\n","                                          smiles    mpC    csid  \\\n","0  c1ccnc(c1)Cc2ccc(cc2[N+](=O)[O-])[N+](=O)[O-]   92.0   64018   \n","1                          c1ccc(c(c1)N)N2CCCCC2   46.0  403764   \n","2                             c1cnc(nc1)N2CCNCC2   33.0   80080   \n","3                          c1ccc(c(c1)N2CCNCC2)O  125.0   63701   \n","4                                 C1CCC(=CC1)CCN  -55.0   69388   \n","\n","                                             link      source donotuse  \\\n","0  http://www.alfa.com/en/GP100W.pgm?DSSTK=B24192  Alfa Aesar      NaN   \n","1  http://www.alfa.com/en/GP100W.pgm?DSSTK=A13073  Alfa Aesar      NaN   \n","2  http://www.alfa.com/en/GP100W.pgm?DSSTK=L15884  Alfa Aesar      NaN   \n","3  http://www.alfa.com/en/GP100W.pgm?DSSTK=B20252  Alfa Aesar      NaN   \n","4  http://www.alfa.com/en/GP100W.pgm?DSSTK=L08261  Alfa Aesar      NaN   \n","\n","  donotusebecause  \n","0             NaN  \n","1             NaN  \n","2             NaN  \n","3             NaN  \n","4             NaN  "]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["bradley.head()"]},{"cell_type":"code","execution_count":6,"id":"5cb9494d","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:03:02.04201Z","iopub.status.busy":"2025-11-08T14:03:02.041793Z","iopub.status.idle":"2025-11-08T14:03:02.061677Z","shell.execute_reply":"2025-11-08T14:03:02.061082Z"},"papermill":{"duration":0.027317,"end_time":"2025-11-08T14:03:02.062755","exception":false,"start_time":"2025-11-08T14:03:02.035438","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>SMILES</th>\n","      <th>Tm</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>c1ccnc(c1)Cc2ccc(cc2[N+](=O)[O-])[N+](=O)[O-]</td>\n","      <td>365.15</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>c1ccc(c(c1)N)N2CCCCC2</td>\n","      <td>319.15</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>c1cnc(nc1)N2CCNCC2</td>\n","      <td>306.15</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>c1ccc(c(c1)N2CCNCC2)O</td>\n","      <td>398.15</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>C1CCC(=CC1)CCN</td>\n","      <td>218.15</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>3036</th>\n","      <td>C1=CC(=CC=C1C(=O)O)[N+](=O)[O-]</td>\n","      <td>513.15</td>\n","    </tr>\n","    <tr>\n","      <th>3037</th>\n","      <td>C1CC(=O)NC(=O)C1N2C(=O)C3=CC=CC=C3C2=O</td>\n","      <td>548.15</td>\n","    </tr>\n","    <tr>\n","      <th>3038</th>\n","      <td>C[C@]12CC[C@H]3[C@H]([C@@H]1CC[C@@H]2O)CCC4=C3...</td>\n","      <td>449.15</td>\n","    </tr>\n","    <tr>\n","      <th>3039</th>\n","      <td>C1=C(C=C(C(=C1Cl)O)Cl)Cl</td>\n","      <td>338.15</td>\n","    </tr>\n","    <tr>\n","      <th>3040</th>\n","      <td>c1ccc(c(c1)C(F)(F)F)N</td>\n","      <td>239.15</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>31686 rows × 2 columns</p>\n","</div>"],"text/plain":["                                                 SMILES      Tm\n","0         c1ccnc(c1)Cc2ccc(cc2[N+](=O)[O-])[N+](=O)[O-]  365.15\n","1                                 c1ccc(c(c1)N)N2CCCCC2  319.15\n","2                                    c1cnc(nc1)N2CCNCC2  306.15\n","3                                 c1ccc(c(c1)N2CCNCC2)O  398.15\n","4                                        C1CCC(=CC1)CCN  218.15\n","...                                                 ...     ...\n","3036                    C1=CC(=CC=C1C(=O)O)[N+](=O)[O-]  513.15\n","3037             C1CC(=O)NC(=O)C1N2C(=O)C3=CC=CC=C3C2=O  548.15\n","3038  C[C@]12CC[C@H]3[C@H]([C@@H]1CC[C@@H]2O)CCC4=C3...  449.15\n","3039                           C1=C(C=C(C(=C1Cl)O)Cl)Cl  338.15\n","3040                              c1ccc(c(c1)C(F)(F)F)N  239.15\n","\n","[31686 rows x 2 columns]"]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["# tm clesius me diya ha we will convert it into kelvin \n","# to convert it into kelvin \n","bradley['Tm'] = bradley['mpC'].map(lambda x : x + 273.15)\n","# same with bradleyplus \n","bradleyplus['Tm'] = bradleyplus['mpC'].map(lambda x : x + 273.15)\n","\n","# hum sirf smiles and unka tm rakh rahe hai \n","bradley = bradley[['smiles', 'Tm']]\n","bradleyplus = bradleyplus[['smiles', 'Tm']]\n","\n","bradley_df = pd.concat((bradley, bradleyplus), axis = 0)\n","bradley_df = bradley_df.rename(columns = {'smiles': 'SMILES'})\n","\n","bradley_df"]},{"cell_type":"code","execution_count":7,"id":"ff3510e0","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:03:02.075433Z","iopub.status.busy":"2025-11-08T14:03:02.07481Z","iopub.status.idle":"2025-11-08T14:03:02.083051Z","shell.execute_reply":"2025-11-08T14:03:02.082336Z"},"papermill":{"duration":0.015615,"end_time":"2025-11-08T14:03:02.08408","exception":false,"start_time":"2025-11-08T14:03:02.068465","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>SMILES</th>\n","      <th>Tm</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>FC1=C(F)C(F)(F)C1(F)F</td>\n","      <td>213.15</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>c1ccc2c(c1)ccc3Nc4ccccc4c23</td>\n","      <td>407.15</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>CCN1C(C)=Nc2ccccc12</td>\n","      <td>324.15</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>CC#CC(=O)O</td>\n","      <td>351.15</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>CCCCC(S)C</td>\n","      <td>126.15</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>3036</th>\n","      <td>C1=CC(=CC=C1C(=O)O)[N+](=O)[O-]</td>\n","      <td>513.15</td>\n","    </tr>\n","    <tr>\n","      <th>3037</th>\n","      <td>C1CC(=O)NC(=O)C1N2C(=O)C3=CC=CC=C3C2=O</td>\n","      <td>548.15</td>\n","    </tr>\n","    <tr>\n","      <th>3038</th>\n","      <td>C[C@]12CC[C@H]3[C@H]([C@@H]1CC[C@@H]2O)CCC4=C3...</td>\n","      <td>449.15</td>\n","    </tr>\n","    <tr>\n","      <th>3039</th>\n","      <td>C1=C(C=C(C(=C1Cl)O)Cl)Cl</td>\n","      <td>338.15</td>\n","    </tr>\n","    <tr>\n","      <th>3040</th>\n","      <td>c1ccc(c(c1)C(F)(F)F)N</td>\n","      <td>239.15</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>34348 rows × 2 columns</p>\n","</div>"],"text/plain":["                                                 SMILES      Tm\n","0                                 FC1=C(F)C(F)(F)C1(F)F  213.15\n","1                           c1ccc2c(c1)ccc3Nc4ccccc4c23  407.15\n","2                                   CCN1C(C)=Nc2ccccc12  324.15\n","3                                            CC#CC(=O)O  351.15\n","4                                             CCCCC(S)C  126.15\n","...                                                 ...     ...\n","3036                    C1=CC(=CC=C1C(=O)O)[N+](=O)[O-]  513.15\n","3037             C1CC(=O)NC(=O)C1N2C(=O)C3=CC=CC=C3C2=O  548.15\n","3038  C[C@]12CC[C@H]3[C@H]([C@@H]1CC[C@@H]2O)CCC4=C3...  449.15\n","3039                           C1=C(C=C(C(=C1Cl)O)Cl)Cl  338.15\n","3040                              c1ccc(c(c1)C(F)(F)F)N  239.15\n","\n","[34348 rows x 2 columns]"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["# we will merge the bradley data and train data together \n","\n","merge = pd.concat((train ,bradley_df), axis = 0)\n","\n","merge "]},{"cell_type":"code","execution_count":8,"id":"b6b0351e","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:03:02.098Z","iopub.status.busy":"2025-11-08T14:03:02.097643Z","iopub.status.idle":"2025-11-08T14:03:02.119842Z","shell.execute_reply":"2025-11-08T14:03:02.119086Z"},"papermill":{"duration":0.031075,"end_time":"2025-11-08T14:03:02.121043","exception":false,"start_time":"2025-11-08T14:03:02.089968","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["'0'"]},"metadata":{},"output_type":"display_data"}],"source":["# there are chances that the final dataset merge can have duplicate valeus so remove thpse\n","merge  = merge.drop_duplicates(subset = ['SMILES', 'Tm']).reset_index(drop = True)\n","\n","merge\n","\n","display(f\"{merge.duplicated(subset = ['SMILES', 'Tm']).sum()}\")"]},{"cell_type":"markdown","id":"91f6eb1d","metadata":{"papermill":{"duration":0.005609,"end_time":"2025-11-08T14:03:02.132672","exception":false,"start_time":"2025-11-08T14:03:02.127063","status":"completed"},"tags":[]},"source":["pehle hume smajhna hoga ki secriptor_list dikhta kaisa hai , list where each item is a pair (a tuple) containing; -> a descriptor name , -> the function that calls it . (for name , func in descriptor_list) -> iterates through this list har step pe it unpacks one of the pairs, in first loop name will be molwt and function will be the molwt function , in second loop name will be 'numhdonors' and func will be the numhdonors and so on. \n","name: this becomes the key in the new dictionary funct(mol) it calls the function that was just unpacked and passes your mol to it, the result becomes the value {..} the curly braces tell python to collect all these generated keys-value pairs and put them together into a single new dictionary ."]},{"cell_type":"code","execution_count":9,"id":"ea5324b7","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:03:02.144943Z","iopub.status.busy":"2025-11-08T14:03:02.144737Z","iopub.status.idle":"2025-11-08T14:05:51.005549Z","shell.execute_reply":"2025-11-08T14:05:51.004715Z"},"papermill":{"duration":168.874413,"end_time":"2025-11-08T14:05:51.012746","exception":false,"start_time":"2025-11-08T14:03:02.138333","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>SMILES</th>\n","      <th>Tm</th>\n","      <th>MaxAbsEStateIndex</th>\n","      <th>MaxEStateIndex</th>\n","      <th>MinAbsEStateIndex</th>\n","      <th>MinEStateIndex</th>\n","      <th>qed</th>\n","      <th>SPS</th>\n","      <th>MolWt</th>\n","      <th>HeavyAtomMolWt</th>\n","      <th>...</th>\n","      <th>fr_sulfide</th>\n","      <th>fr_sulfonamd</th>\n","      <th>fr_sulfone</th>\n","      <th>fr_term_acetylene</th>\n","      <th>fr_tetrazole</th>\n","      <th>fr_thiazole</th>\n","      <th>fr_thiocyan</th>\n","      <th>fr_thiophene</th>\n","      <th>fr_unbrch_alkane</th>\n","      <th>fr_urea</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>FC1=C(F)C(F)(F)C1(F)F</td>\n","      <td>213.15</td>\n","      <td>11.537037</td>\n","      <td>11.537037</td>\n","      <td>2.668981</td>\n","      <td>-4.947338</td>\n","      <td>0.479530</td>\n","      <td>28.200000</td>\n","      <td>162.032</td>\n","      <td>162.032</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>c1ccc2c(c1)ccc3Nc4ccccc4c23</td>\n","      <td>407.15</td>\n","      <td>3.470111</td>\n","      <td>3.470111</td>\n","      <td>1.207271</td>\n","      <td>1.207271</td>\n","      <td>0.446879</td>\n","      <td>11.529412</td>\n","      <td>217.271</td>\n","      <td>206.183</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>CCN1C(C)=Nc2ccccc12</td>\n","      <td>324.15</td>\n","      <td>4.446898</td>\n","      <td>4.446898</td>\n","      <td>0.992407</td>\n","      <td>0.992407</td>\n","      <td>0.625839</td>\n","      <td>10.833333</td>\n","      <td>160.220</td>\n","      <td>148.124</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>CC#CC(=O)O</td>\n","      <td>351.15</td>\n","      <td>9.425694</td>\n","      <td>9.425694</td>\n","      <td>1.071759</td>\n","      <td>-1.071759</td>\n","      <td>0.422302</td>\n","      <td>5.500000</td>\n","      <td>84.074</td>\n","      <td>80.042</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>CCCCC(S)C</td>\n","      <td>126.15</td>\n","      <td>4.232083</td>\n","      <td>4.232083</td>\n","      <td>0.597176</td>\n","      <td>0.597176</td>\n","      <td>0.540734</td>\n","      <td>14.142857</td>\n","      <td>118.245</td>\n","      <td>104.133</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28803</th>\n","      <td>OCC(c1ccc2c(c1)ccc(OC)c2)C</td>\n","      <td>360.15</td>\n","      <td>12.412307</td>\n","      <td>12.412307</td>\n","      <td>0.064063</td>\n","      <td>-0.614534</td>\n","      <td>0.747626</td>\n","      <td>12.217391</td>\n","      <td>308.333</td>\n","      <td>292.205</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>28804</th>\n","      <td>O=C(OCC(c1ccc2c(c1)ccc(OC)c2)C)C</td>\n","      <td>334.15</td>\n","      <td>5.777407</td>\n","      <td>5.777407</td>\n","      <td>0.978519</td>\n","      <td>0.978519</td>\n","      <td>0.517522</td>\n","      <td>12.571429</td>\n","      <td>182.222</td>\n","      <td>172.142</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>28805</th>\n","      <td>c1cc(cnc1)C(=O)O</td>\n","      <td>509.75</td>\n","      <td>5.777407</td>\n","      <td>5.777407</td>\n","      <td>0.978519</td>\n","      <td>0.978519</td>\n","      <td>0.517522</td>\n","      <td>12.571429</td>\n","      <td>182.222</td>\n","      <td>172.142</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>28806</th>\n","      <td>C1=CC(=CN=C1)C(=O)O</td>\n","      <td>509.75</td>\n","      <td>5.777407</td>\n","      <td>5.777407</td>\n","      <td>0.978519</td>\n","      <td>0.978519</td>\n","      <td>0.517522</td>\n","      <td>12.571429</td>\n","      <td>182.222</td>\n","      <td>172.142</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>28807</th>\n","      <td>O=C(OC)\\C1=C(\\N/C(=C(/C(=O)OC)C1c2ccccc2[N+]([...</td>\n","      <td>446.15</td>\n","      <td>7.729444</td>\n","      <td>7.729444</td>\n","      <td>1.430556</td>\n","      <td>1.430556</td>\n","      <td>0.388843</td>\n","      <td>8.000000</td>\n","      <td>67.091</td>\n","      <td>62.051</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28808 rows × 219 columns</p>\n","</div>"],"text/plain":["                                                  SMILES      Tm  \\\n","0                                  FC1=C(F)C(F)(F)C1(F)F  213.15   \n","1                            c1ccc2c(c1)ccc3Nc4ccccc4c23  407.15   \n","2                                    CCN1C(C)=Nc2ccccc12  324.15   \n","3                                             CC#CC(=O)O  351.15   \n","4                                              CCCCC(S)C  126.15   \n","...                                                  ...     ...   \n","28803                         OCC(c1ccc2c(c1)ccc(OC)c2)C  360.15   \n","28804                   O=C(OCC(c1ccc2c(c1)ccc(OC)c2)C)C  334.15   \n","28805                                   c1cc(cnc1)C(=O)O  509.75   \n","28806                                C1=CC(=CN=C1)C(=O)O  509.75   \n","28807  O=C(OC)\\C1=C(\\N/C(=C(/C(=O)OC)C1c2ccccc2[N+]([...  446.15   \n","\n","       MaxAbsEStateIndex  MaxEStateIndex  MinAbsEStateIndex  MinEStateIndex  \\\n","0              11.537037       11.537037           2.668981       -4.947338   \n","1               3.470111        3.470111           1.207271        1.207271   \n","2               4.446898        4.446898           0.992407        0.992407   \n","3               9.425694        9.425694           1.071759       -1.071759   \n","4               4.232083        4.232083           0.597176        0.597176   \n","...                  ...             ...                ...             ...   \n","28803          12.412307       12.412307           0.064063       -0.614534   \n","28804           5.777407        5.777407           0.978519        0.978519   \n","28805           5.777407        5.777407           0.978519        0.978519   \n","28806           5.777407        5.777407           0.978519        0.978519   \n","28807           7.729444        7.729444           1.430556        1.430556   \n","\n","            qed        SPS    MolWt  HeavyAtomMolWt  ...  fr_sulfide  \\\n","0      0.479530  28.200000  162.032         162.032  ...         0.0   \n","1      0.446879  11.529412  217.271         206.183  ...         0.0   \n","2      0.625839  10.833333  160.220         148.124  ...         0.0   \n","3      0.422302   5.500000   84.074          80.042  ...         0.0   \n","4      0.540734  14.142857  118.245         104.133  ...         0.0   \n","...         ...        ...      ...             ...  ...         ...   \n","28803  0.747626  12.217391  308.333         292.205  ...         0.0   \n","28804  0.517522  12.571429  182.222         172.142  ...         0.0   \n","28805  0.517522  12.571429  182.222         172.142  ...         0.0   \n","28806  0.517522  12.571429  182.222         172.142  ...         0.0   \n","28807  0.388843   8.000000   67.091          62.051  ...         0.0   \n","\n","       fr_sulfonamd  fr_sulfone  fr_term_acetylene  fr_tetrazole  fr_thiazole  \\\n","0               0.0         0.0                0.0           0.0          0.0   \n","1               0.0         0.0                0.0           0.0          0.0   \n","2               0.0         0.0                0.0           0.0          0.0   \n","3               0.0         0.0                0.0           0.0          0.0   \n","4               0.0         0.0                0.0           0.0          0.0   \n","...             ...         ...                ...           ...          ...   \n","28803           0.0         0.0                0.0           0.0          0.0   \n","28804           0.0         0.0                0.0           0.0          0.0   \n","28805           0.0         0.0                0.0           0.0          0.0   \n","28806           0.0         0.0                0.0           0.0          0.0   \n","28807           0.0         0.0                0.0           0.0          0.0   \n","\n","       fr_thiocyan  fr_thiophene  fr_unbrch_alkane  fr_urea  \n","0              0.0           0.0               0.0      0.0  \n","1              0.0           0.0               0.0      0.0  \n","2              0.0           0.0               0.0      0.0  \n","3              0.0           0.0               0.0      0.0  \n","4              0.0           0.0               1.0      0.0  \n","...            ...           ...               ...      ...  \n","28803          0.0           0.0               0.0      0.0  \n","28804          0.0           0.0               0.0      0.0  \n","28805          0.0           0.0               0.0      0.0  \n","28806          0.0           0.0               0.0      0.0  \n","28807          0.0           0.0               0.0      0.0  \n","\n","[28808 rows x 219 columns]"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["def extract_all_descriptors(df, SMILES):\n","    descriptor_list = Descriptors.descList \n","    # Descriptors.descList -> contain all descriptors names and function\n","    descriptors = [desc[0] for desc in descriptor_list]\n","\n","\n","    result = []\n","    for smi in df[SMILES]:\n","        mol = Chem.MolFromSmiles(smi)\n","\n","        if mol is None:\n","            row = {name: None for name , func in descriptor_list}\n","        else:\n","            row = {name: func(mol) for name , func in descriptor_list}\n","            result.append(row)\n","\n","    df_descriptor = pd.DataFrame(result) # converting into a dataset \n","    df_result = pd.concat((df, df_descriptor), axis = 1)\n","\n","    return df_result\n","\n","merge = extract_all_descriptors(merge, 'SMILES')\n","\n","test = extract_all_descriptors(test, 'SMILES')\n","\n","merge = merge.dropna().reset_index(drop = True)\n","test = test.dropna().reset_index(drop = True)\n","\n","merge\n"]},{"cell_type":"code","execution_count":10,"id":"c4ded5ab","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:05:51.026008Z","iopub.status.busy":"2025-11-08T14:05:51.025603Z","iopub.status.idle":"2025-11-08T14:08:19.856938Z","shell.execute_reply":"2025-11-08T14:08:19.855928Z"},"papermill":{"duration":148.83922,"end_time":"2025-11-08T14:08:19.858102","exception":false,"start_time":"2025-11-08T14:05:51.018882","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[Cl+3]([O-])([O-])([O-])[O-].o1c2[c+]cc(C)c3cc(oc3c2c2cc(OC)ccc12)C is Invalid!\n","Brc1cc2c3c(oc2c(Br)c1)[c+]cc(C)c1cc(oc13)C.[Cl+3]([O-])([O-])([O-])[O-] is Invalid!\n","Clc1ccc2oc3[c+]cc(C)c4cc(oc4c3c2c1)C.[Cl+3]([O-])([O-])([O-])[O-] is Invalid!\n","[Cl+3]([O-])([O-])([O-])[O-].o1c2[c+]cc(C)c3cc(oc3c2c2cc(C)ccc12)C is Invalid!\n","[Cl+3]([O-])([O-])([O-])[O-].o1c2[c+]cc(C)c3cc(oc3c2c2ccccc12)C is Invalid!\n","[P+](c1ccccc1)(c1ccccc1)(c1ccccc1)C(=C=1C=CC=CC=1)c1ccccc1 is Invalid!\n","O=C(OC)[C@@]2(C[C@H]4C[C@@](O)(CC)C[N@@](CCc1c3ccccc3nc12)C4)c5cc9c(cc5OC)N(C=O)[C@@H]6[C@]98CCN7CC=C[C@@](CC)([C@@H](OC(C)=O)[C@]6(O)C(=O)OC)[C@H]78 is Invalid!\n","CCN(CC)C(=O)[C@@H]2C=C1c3cccc4ncc(C[C@H]1N(C)C2)c34 is Invalid!\n","O=C2c1ncnc1N(C)C(=O)N2C is Invalid!\n","c1cnnn1 is Invalid!\n","Nc1ncnn1 is Invalid!\n","c1cccc2ncnc12 is Invalid!\n","Sc1nc2ccccc2n1 is Invalid!\n","c1cccc2nnnc12 is Invalid!\n","c1cncn1 is Invalid!\n","c1cccc2nccc12 is Invalid!\n","c1cccn1 is Invalid!\n","n1c3ccccc3nc1c2cscn2 is Invalid!\n","[O-][N+](=O)c1cnc(C)n1 is Invalid!\n","Brc1cc2c3cc(Br)ccc3nc2cc1 is Invalid!\n","Cc2cnc1ccccc12 is Invalid!\n","Clc1cc2nc(C)nc2cc1 is Invalid!\n","Cc1cc2nnnc2cc1 is Invalid!\n","[O-][N+](=O)c1ccc2ncnc2c1 is Invalid!\n","c1cccc2nc3ccccc3c12 is Invalid!\n","COc1cc(cc(OC)c1OC)/C=C/C(=O)O[C@@H]3C[C@@H]4CN5CCc2c6ccc(OC)cc6nc2[C@H]5C[C@@H]4[C@@H]([C@H]3OC)C(=O)OC is Invalid!\n","O=C(O)[C@@H](NC(C)=O)Cc2cnc1ccccc12 is Invalid!\n","CC(=O)NC(=O)[C@@H](N)Cc2cnc1ccccc12 is Invalid!\n","n2cnc(NCc1ccccc1)c3ncnc23 is Invalid!\n","FBr(F)(F)(F)F is Invalid!\n","FBr(F)F is Invalid!\n","FCl(F)F is Invalid!\n","Cc1cnnc1 is Invalid!\n","CCNC(=O)N(CCCN(C)C)C(=O)[C@@H]1C[C@@H]2c3cccc4ncc(C[C@H]2N(C1)CC=C)c34 is Invalid!\n","O=C(O)[C@H](C(C)C)N(Cc1ccc(cc1)c2ccccc2c3nnnn3)C(=O)CCCC is Invalid!\n","CN=C(/NC#N)NCCSCc1ncnc1C is Invalid!\n","CCN(CC)CCc2cnc1ccccc12 is Invalid!\n","CNS(=O)(=O)Cc1cc2c(cc1)ncc2CCN(C)C is Invalid!\n","CC=5OC(=O)OC=5COC(=O)c4c(nc(CCC)n4Cc1ccc(cc1)c3ccccc3c2nnnn2)C(C)(C)O is Invalid!\n","CN(C)CCc2cnc1ccc(cc12)Cn3cncn3 is Invalid!\n","FC(F)(F)COc3ccnc(CS(=O)c1nc2ccccc2n1)c3C is Invalid!\n","CCCCC5=NC1(CCCC1)C(=O)N5Cc2ccc(cc2)c3ccccc3c4nnnn4 is Invalid!\n","CC(C)N(CCc2cnc1ccc(cc12)OC)C(C)C is Invalid!\n","O=C(O)C(C)c1ccc2c3cc(Cl)ccc3nc2c1 is Invalid!\n","O=C(OC)[C@@]2(C[C@H]4C[C@@](O)(CC)CN(CCc1c3ccccc3nc12)C4)c5cc9c(cc5OC)N(C=O)[C@@H]8[C@]97CCN6CC=C[C@](CC)([C@H]67)[C@@H](OC(C)=O)[C@]8(O)C(=O)OC is Invalid!\n","O=C(O)C[C@H]3NC(=O)[C@H](Cc1cncn1)NC(=O)[C@@H](Cc2ccccc2)NC(=O)[C@@H](NC(=O)[C@@H](CCCN)NC(=O)[C@H](CCCCNC(=O)[C@H](CC(N)=O)NC3=O)NC(=O)[C@@H](NC(=O)[C@@H](CCC(=O)O)NC(=O)[C@H](CC(C)C)NC(=O)C4CN=C(S4)[C@@H](N)C(C)CC)C(C)CC)C(C)CC is Invalid!\n","O=C(c1cc2cc(NS(C)(=O)=O)ccc2n1)N3CCN(CC3)c4ncccc4NC(C)C is Invalid!\n","NC(=O)[C@H](Cc1ccccc1)NC(=O)[C@H](CC(=O)O)NC(=O)[C@H](CCSC)NC(=O)[C@@H](NC(=O)CCNC(=O)OCC(C)C)Cc3cnc2ccccc23 is Invalid!\n","COc1cc(cc(OC)c1OC)/C=C/C(=O)O[C@@H]3C[C@@H]4CN5CCc2c6ccc(OC)cc6nc2[C@H]5C[C@@H]4[C@H](C(=O)OC)[C@H]3OC is Invalid!\n","O=C(OC)[C@@]2(C[C@H]4C[C@@](O)(CC)CN(CCc1c3ccccc3nc12)C4)c5cc9c(cc5OC)N(C)[C@@H]8[C@]97CCN6CC=C[C@](CC)([C@H]67)[C@@H](OC(C)=O)[C@]8(O)C(=O)OC is Invalid!\n","O=C(OC1CC3CC2C[C@H](C1)N3CC2=O)c5cnc4ccccc45 is Invalid!\n","O=C6N(C)CC(=O)N4[C@@H]6Cc1c5ccccc5nc1[C@H]4c2ccc3OCOc3c2 is Invalid!\n","S=C2N=CNc1ncnc12 is Invalid!\n","CN2C[C@@H](C=C1c3cccc4ncc(C[C@H]12)c34)C(=O)N[C@]5(C)O[C@]8(O)N(C5=O)[C@@H](Cc6ccccc6)C(=O)N7CCC[C@H]78 is Invalid!\n","N[C@@H](Cc1cncn1)C(=O)O is Invalid!\n","Cc1ccc2ncnc2c1 is Invalid!\n","CC(C)NCC(O)COc2cccc1nccc12 is Invalid!\n","Ic1cnnc1 is Invalid!\n","Cc3c(OC)c(C)cnc3CS(=O)c1nc2ccc(cc2n1)OC is Invalid!\n","O=C2c1ncnc1N(C)C(=O)N2C is Invalid!\n","O=C2NC(=O)N(CCC)c1ncnc12 is Invalid!\n","O=C(O)[C@@H](N)Cc2cnc1ccccc12 is Invalid!\n","Cc1ccnc1 is Invalid!\n","CN(C)CCc2cnc1ccccc12 is Invalid!\n","COc4ccccc4OCCNCC(O)COc2cccc3nc1ccccc1c23 is Invalid!\n","CC(=O)NCCc2cnc1ccc(cc12)OC is Invalid!\n","O=C(O)CCCc2cnc1ccccc12 is Invalid!\n","C=CCN3CCCC3CNC(=O)c1cc2nnnc2cc1OC is Invalid!\n","CN(C)CCc2cnc1ccc(O)cc12 is Invalid!\n","O=C(O)CC3(CC)OCCc2c3nc1c(cccc12)CC is Invalid!\n","Cc3c(OC)c(C)cnc3CS(=O)c1nc2ccc(cc2n1)OC is Invalid!\n","C[C@@H](CO)NC(=O)[C@@H]2C=C1c3cccc4ncc(C[C@H]1N(C)C2)c34 is Invalid!\n","CC[C@@H](CO)NC(=O)[C@@H]2C=C1c3cccc4ncc(C[C@H]1N(C)C2)c34 is Invalid!\n","O=C1C(CCc2nc(C)c(CC)c12)CN3CCOCC3 is Invalid!\n","OCc4c(Cl)nc(CCCC)n4Cc1ccc(cc1)c2ccccc2c3nnnn3 is Invalid!\n","O=C(N)c1ncnc1/N=N/N(C)C is Invalid!\n","Cc1cc2ncnc2cc1C is Invalid!\n","CSC[C@@H]1C[C@@H]2c3cccc4ncc(C[C@H]2N(C1)CCC)c34 is Invalid!\n","O=C(OC)Nc1nc2ccc(cc2n1)SCCC is Invalid!\n","OC(=O)/C=C/c1cncn1 is Invalid!\n","COc1cc(cc(OC)c1OC)C(=O)O[C@@H]3C[C@@H]4CN5CCc2c6ccccc6nc2[C@H]5C[C@@H]4[C@H](C(=O)OC)[C@H]3OC is Invalid!\n","O=C(OC)[C@@]2(C[C@H]4C[C@@](O)(CC)CN(CCc1c3ccccc3nc12)C4)c5cc9c(cc5OC)N(C)[C@@H]8[C@]97CCN6CC=C[C@](CC)([C@H]67)[C@@H](O)[C@]8(O)C(N)=O is Invalid!\n","O=C(OC)[C@H]2[C@@H](O)CC[C@H]3CN4CCc1c5ccccc5nc1[C@@H]4C[C@H]23 is Invalid!\n","O=[N+]([O-])c3ncn(C)c3Sc2ncnc1ncnc12 is Invalid!\n","COc1cc(cc(OC)c1OC)C(=O)O[C@@H]3C[C@@H]4CN5CCc2c6ccc(OC)cc6nc2[C@H]5C[C@@H]4[C@H](C(=O)OC)[C@H]3OC is Invalid!\n","O=C(OC)Nc1nc2ccc(cc2n1)C(=O)c3ccccc3 is Invalid!\n","n1c3ccccc3nc1c2cscn2 is Invalid!\n","NC2=Nc1ncnc1C(=O)N2 is Invalid!\n","Oc2ncnc1nncc12 is Invalid!\n","N#CN=C(NC)NCCSCc1ncnc1C is Invalid!\n","N#Cc3cncc3c1cccc2OC(F)(F)Oc12 is Invalid!\n","CC(C)NCC(O)COc2cccc1nccc12 is Invalid!\n","Clc1cccc(c1Cl)c2cncc2C#N is Invalid!\n","Cc3c(OC)c(C)cnc3CS(=O)c1nc2cc(ccc2n1)OC is Invalid!\n","Nc1nc(N)nc2ncnc12 is Invalid!\n","Cc1cc2c(cc1)nc(C)c2C is Invalid!\n","N#Cc1cc2ccnc2cc1 is Invalid!\n","Brc1cc2ccnc2cc1 is Invalid!\n","Cc1nnc(Cl)c1[N+](=O)[O-] is Invalid!\n","[O-][N+](=O)c1cc2ccnc2cc1 is Invalid!\n","Cc1cc2c3ccccc3nc2cc1 is Invalid!\n","FC(F)(F)c2nc1c(ccc(Cl)c1Cl)n2 is Invalid!\n","Brc1cnnc1 is Invalid!\n","Oc1cc2ccnc2cc1 is Invalid!\n","CCc1nc2ccccc2n1 is Invalid!\n","Cc1ncc(C)c1C(=O)C is Invalid!\n","Cc1ccnn1 is Invalid!\n","c1c(ccc2nccc12)OCc3ccccc3 is Invalid!\n","CC(=O)c1cccn1 is Invalid!\n","Clc2cncc2c1cccc(Cl)c1[N+]([O-])=O is Invalid!\n","COc1cc2ccnc2cc1 is Invalid!\n","O=Cc1cccn1 is Invalid!\n","c1cccc3c1cc(c2ccccc2)n3 is Invalid!\n","C2CCCc3nc1ccccc1c23 is Invalid!\n","Nc1nc2ccccc2n1 is Invalid!\n","Cc1cncn1 is Invalid!\n","O=C(OCC)Cc2cnc1ccccc12 is Invalid!\n","CC(=O)c2cnc1ccccc12 is Invalid!\n","Cc1nccn1 is Invalid!\n","Cc1cccn1 is Invalid!\n","Cc1ccc(C)n1 is Invalid!\n","c1cccc2nc(nc12)Cc3ccccc3 is Invalid!\n","Cc1nc2ccccc2n1 is Invalid!\n","Cc1cc2ncnc2cc1 is Invalid!\n","Cc1cc2ccnc2cc1 is Invalid!\n","CC(=O)Oc2cnc1ccccc12 is Invalid!\n","OCCc2cnc1ccccc12 is Invalid!\n","O=P(O)(O)Oc1cccc2c1c(cn2)CCN(C)C is Invalid!\n","Cc1ncc(C)c1CC is Invalid!\n","O=Cc2cnc1ccccc12 is Invalid!\n","c1ccc(cc1)c2nc(c(n2)c3ccccc3)c4ccccc4 is Invalid!\n","O=C(O)C(NC(=O)CCN)Cc1cncn1 is Invalid!\n","CC(N)Cc2cnc1ccccc12 is Invalid!\n","c1ncnn1 is Invalid!\n","c1cncc2ncnc12 is Invalid!\n","c1ccnc2nccc12 is Invalid!\n","c1cccc2nncc12 is Invalid!\n","c1cccc3c1ccc2nc4ccc5ccccc5c4c23 is Invalid!\n","Cc1cc2nnnc2cc1 is Invalid!\n","O=C1N=C(N)Nc2nnnc12 is Invalid!\n","CCC(N)Cc2cnc1ccccc12 is Invalid!\n","c1cccn1 is Invalid!\n","Cc1cc2ccccc2n1 is Invalid!\n","c1cccc2nnnc12 is Invalid!\n","[O-][N+](=O)c1cc2ncnc2cc1 is Invalid!\n","Cc1c2ccccc2nc1C is Invalid!\n","CN(C)Cc2cnc1ccccc12 is Invalid!\n","c1cccc2nc3ccccc3c12 is Invalid!\n","Cc2cnc1ccccc12 is Invalid!\n","Cc1cc(C)nn1 is Invalid!\n","CNCCc2cnc1ccccc12 is Invalid!\n","c1cccc2ncnc12 is Invalid!\n","COc1cc(cc(OC)c1OC)C(=O)O[C@@H]3C[C@@H]4CN5CCc2c6ccc(OC)cc6nc2[C@H]5C[C@@H]4[C@@H]([C@H]3OC)C(=O)OC is Invalid!\n","O=C(OCC)Oc1c(OC)cc(cc1OC)C(=O)OC2CC3CN4CCc5c6ccc(OC)cc6nc5C4CC3C(C2OC)C(=O)OC is Invalid!\n","CS(=O)c3ccc(c1nc2ncccc2n1)c(OC)c3 is Invalid!\n","Oc1cc2c(cc1)ncc2CCN is Invalid!\n","Cc3c(OCCCOC)ccnc3CS(=O)c1nc2ccccc2n1 is Invalid!\n","CN(C)CCc2cnc1cccc(O)c12 is Invalid!\n","CC(C)NCC(O)COc2cccc1nccc12 is Invalid!\n","CSCC4CC1C(Cc2cnc3cccc1c23)N(C4)CCC is Invalid!\n","O=C(OC)Nc1nc2cc(ccc2n1)OCCC is Invalid!\n","CCC(CO)NC(=O)C4C=C1C(Cc2cnc3cccc1c23)N(C)C4 is Invalid!\n","O=C(OC)Nc1nc2cc(ccc2n1)C(=O)c3ccccc3 is Invalid!\n","CCN(CC)C(=O)C4C=C1C(Cc2cnc3cccc1c23)N(C)C4 is Invalid!\n","n1cnc3ncnc3c1NCc2ccco2 is Invalid!\n","CC(C)CN1c2ncnc2C(=O)N(C)C1=O is Invalid!\n","O=C(O)CCc2cnc1ccccc12 is Invalid!\n","OCc2cnc1ccccc12 is Invalid!\n","CC(CO)NC(=O)C4C=C1C(Cc2cnc3cccc1c23)N(C)C4 is Invalid!\n","O=C(OC)C2C(O)CCC3CN4CCc1c5ccccc5nc1C4CC23 is Invalid!\n","O=C(OC)C2C(O)CCC3CN4CCc1c5ccccc5nc1C4CC23 is Invalid!\n","Cc1ncnc1CSCCN=C(/NC#N)NC is Invalid!\n","NS(=O)(=O)c2cc(c(NCc1cccs1)cc2Cl)c3nnnn3 is Invalid!\n","O=C(OC)Nc1nc2cc(ccc2n1)SCCC is Invalid!\n","O=C(O)C(NC(C)=O)Cc2cnc1ccccc12 is Invalid!\n","O=C(O)c1c(NC)ccc2oc(nc12)CC3OC4(CCC3C)OC(C(C)CC4C)C(C)C(=O)c5cccn5 is Invalid!\n","COc1cc2c(cc1)ncc2CCN is Invalid!\n","CN(C)CCc2cnc1ccc(cc12)OC is Invalid!\n","NCCc2cnc1ccccc12 is Invalid!\n","c1ccnn1 is Invalid!\n","c1ncnc2ncnc12 is Invalid!\n","O=C(O)Cc2cnc1ccccc12 is Invalid!\n","c1cccc2nccc12 is Invalid!\n","c1cncn1 is Invalid!\n","NCCc1cncn1 is Invalid!\n","O=C(O)C(N)Cc2cnc1ccc(O)cc12 is Invalid!\n","Fc1ccc(cc1)C(=O)c2cc3nc(NC(=O)OC)nc3cc2 is Invalid!\n","O=C(OC)Nc1nc2cc(ccc2n1)C(=O)C3CC3 is Invalid!\n","[O-][N+](=O)c1cc2nnnc2cc1 is Invalid!\n","n2cnc(NCc1ccccc1)c3ncnc23 is Invalid!\n","Nc1ccc2c3ccccc3nc2n1 is Invalid!\n","O=C3c5ccccc5N=C2c4nc1ccccc1c4CCN23 is Invalid!\n","c1cccc3c1ccc2nc4ccccc4c23 is Invalid!\n","c1cnnn1 is Invalid!\n","c1nnnn1 is Invalid!\n","FC(F)(F)c1nc2ccccc2n1 is Invalid!\n","OC(=O)c1ncnc1C(O)=O is Invalid!\n","c1ccc(cc1)c2nccn2 is Invalid!\n","O=C(O)c2cnc1ccccc12 is Invalid!\n","Cc1cnc(C)n1 is Invalid!\n","Cc1cnc(CC)n1 is Invalid!\n","Cc1cccc2ccnc12 is Invalid!\n","Cc1nc(C)c(C)c1C is Invalid!\n","Cc1cc2cc(C)nc2cc1 is Invalid!\n","CC(=O)Cc2cnc1ccccc12 is Invalid!\n","CC2NCCc1c3cc(OC)ccc3nc12 is Invalid!\n","CC(C)NCC(O)COc2cccc1nc(C)cc12 is Invalid!\n","c1ccc(cc1)c2cccn2 is Invalid!\n","O=C(O)c1cc2ccccc2n1 is Invalid!\n","O=C(OCC)c1cc2ccccc2n1 is Invalid!\n","[O-][N+](=O)c1cc2nc(C)nc2cc1 is Invalid!\n","Oc2cccc1nccc12 is Invalid!\n","Nc1cnnc1 is Invalid!\n","Nc1cc2ccnc2cc1 is Invalid!\n","Brc1cnnc1C is Invalid!\n","Cc1cccc2nccc12 is Invalid!\n","N#Cc3cncc3c1cccc2OC(F)(F)Oc12 is Invalid!\n","Clc1ccc2ccnc2c1 is Invalid!\n","Nc1cc2cnnc2cc1 is Invalid!\n","Clc1cccc(c1Cl)c2cncc2C#N is Invalid!\n","CC[C@@]23CCc4nc1ccccc1c4CCN(C2)CCC3 is Invalid!\n","Oc1ccc2c3ccccc3nc2c1 is Invalid!\n","O=C(O)C(N)Cc2nnc1ccccc12 is Invalid!\n","Clc2nnc1ccccc12 is Invalid!\n","O=C(OCC)Cc2nnc1ccc(Cl)cc12 is Invalid!\n","Cc1cccc2nnnc12 is Invalid!\n","N#Cc2cnc1ccccc12 is Invalid!\n","Cc1c3ccccc3nc1c2ccccc2 is Invalid!\n","Clc1cc(C)nn1 is Invalid!\n","N#CCc2cnc1ccccc12 is Invalid!\n","O=C(O)C2C(OC)C(O)CC3CN4CCc1c5ccc(OC)cc5nc1C4CC23 is Invalid!\n","O=C(OC)C2(CC4CC(O)(CC)CN(CCc1c3ccccc3nc12)C4)c5cc9c(cc5OC)N(C)C8C97CCN6CC=CC(CC)(C67)C(O)C8(O)C(N)=O is Invalid!\n","COc1cc(cc(OC)c1OC)C(=O)OC2CC3CN4CCc5c6ccccc6nc5C4CC3C(C2OC)C(=O)OC is Invalid!\n","OCCc3c4ccccc4nc3C2CC1CCN2CC1C=C is Invalid!\n","O=C(OC)c2cnc1ccccc12 is Invalid!\n","O=C(O)C2C=C1c3cccc4ncc(CC1N(C)C2)c34 is Invalid!\n","CCN(CC)C(=O)C4C=C1C(Cc2c(Br)nc3cccc1c23)N(C)C4 is Invalid!\n","Cc1nnc(C)c1Cl is Invalid!\n","CC(CO)=CCNc1ncnc2ncnc12 is Invalid!\n","Sc1nc2ccccc2n1 is Invalid!\n","Sc1nccn1 is Invalid!\n","O=C(OC)C2(CC4CC(O)(CC)CN(CCc1c3ccccc3nc12)C4)c5cc9c(cc5OC)N(C)C8C97CCN6CC=CC(CC)(C67)C(OC(C)=O)C8(O)C(=O)OC is Invalid!\n","COc4cc5nc1c(CCN3CC2CC1C3C(C2)CC)c5cc4 is Invalid!\n","COc1ccc3c(c1)nc2c3ccnc2C is Invalid!\n","Cc2nccc1c3ccccc3nc12 is Invalid!\n","O=C(OC)C(=COC)/C2CC3c4nc1cccc(OC)c1c4CCN3CC2CC is Invalid!\n","COc1ccc(cc1)CNC(=O)C(=O)c3cnc2ccc(cc23)[N+]([O-])=O is Invalid!\n","Oc1ccc(cc1)CNC(=O)C(=O)c3cnc2ccc(cc23)[N+]([O-])=O is Invalid!\n","COc1ccc3c(c1)nc2c3CCN=C2C is Invalid!\n","CC(CO)=CC1c3cccc2ncc(CC1NC)c23 is Invalid!\n","Cc1ccc2nc(C)nc2c1 is Invalid!\n","O=C(NC3CCN(CCc1cc2ccccc2n1)CC3)c4ccccc4 is Invalid!\n","O=S(=O)(OC)ON(C)(C)(C)C(C)CN1c3ccccc3Sc2ccccc12 is Invalid!\n","COC1CCC2CC3C4C=CC(O)C5OC1C2C45CCN3(Br)(C)C is Invalid!\n","CCC(=O)C(CC(C)N(C)(C)Cl)(c1ccccc1)c2ccccc2 is Invalid!\n","O=C(OCC)C(Cc2cnc1ccccc12)N(C)C=O is Invalid!\n","[O-]ClCl=O.[Ca+2] is Invalid!\n","BN(C)(C)C is Invalid!\n","CCCC[N](CCCC)(CCCC)CCCC is Invalid!\n","CN(C)(C)Cl is Invalid!\n","OC=1/C=C\\CN(=O)C=1 is Invalid!\n","FB(F)(F)O(CC)CC is Invalid!\n","O=C(OC(COP(O)(=O)OCCN(C)(C)C)COC(=O)CCCCCCCCCCCCCCC)CCCCCCCCCCCCCCC is Invalid!\n","OC(COP(O)(=O)OCCN(C)(C)C)CO is Invalid!\n","Cl[C@@]3(Cc2c1c(cccc1)nc2C[C@@H]3CCC#N)C is Invalid!\n","Clp2(Cl)np1(OCC(CO1)(C)C)np(Cl)(Cl)n2 is Invalid!\n","O=C(OCc1c(C=O)ncc1)C is Invalid!\n","n1cnnc1 is Invalid!\n","[O-][N+](=O)c1cnc(n1)C is Invalid!\n","n2c1ccccc1nc2C is Invalid!\n","O=C(O)\\C=C\\c2c1ccccc1nc2 is Invalid!\n","S=C2/N=C\\Nc1ncnc12 is Invalid!\n","O=C(O)Cc2c1ccccc1nc2 is Invalid!\n","O=C(O)[C@@H](N)Cc1cncn1 is Invalid!\n","There are 1024 Morgan Fingerprint Features\n","There are 167 MACCS Keys Features\n","There are 2048 RDKIT Fingerprint Features\n","There are 1024 Morgan Fingerprint Features\n","There are 167 MACCS Keys Features\n","There are 2048 RDKIT Fingerprint Features\n"]},{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>SMILES</th>\n","      <th>Tm</th>\n","      <th>MaxAbsEStateIndex</th>\n","      <th>MaxEStateIndex</th>\n","      <th>MinAbsEStateIndex</th>\n","      <th>MinEStateIndex</th>\n","      <th>qed</th>\n","      <th>SPS</th>\n","      <th>MolWt</th>\n","      <th>HeavyAtomMolWt</th>\n","      <th>...</th>\n","      <th>RDKIT_2038</th>\n","      <th>RDKIT_2039</th>\n","      <th>RDKIT_2040</th>\n","      <th>RDKIT_2041</th>\n","      <th>RDKIT_2042</th>\n","      <th>RDKIT_2043</th>\n","      <th>RDKIT_2044</th>\n","      <th>RDKIT_2045</th>\n","      <th>RDKIT_2046</th>\n","      <th>RDKIT_2047</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>FC1=C(F)C(F)(F)C1(F)F</td>\n","      <td>213.15</td>\n","      <td>11.537037</td>\n","      <td>11.537037</td>\n","      <td>2.668981</td>\n","      <td>-4.947338</td>\n","      <td>0.479530</td>\n","      <td>28.200000</td>\n","      <td>162.032</td>\n","      <td>162.032</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>c1ccc2c(c1)ccc3Nc4ccccc4c23</td>\n","      <td>407.15</td>\n","      <td>3.470111</td>\n","      <td>3.470111</td>\n","      <td>1.207271</td>\n","      <td>1.207271</td>\n","      <td>0.446879</td>\n","      <td>11.529412</td>\n","      <td>217.271</td>\n","      <td>206.183</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>CCN1C(C)=Nc2ccccc12</td>\n","      <td>324.15</td>\n","      <td>4.446898</td>\n","      <td>4.446898</td>\n","      <td>0.992407</td>\n","      <td>0.992407</td>\n","      <td>0.625839</td>\n","      <td>10.833333</td>\n","      <td>160.220</td>\n","      <td>148.124</td>\n","      <td>...</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>CC#CC(=O)O</td>\n","      <td>351.15</td>\n","      <td>9.425694</td>\n","      <td>9.425694</td>\n","      <td>1.071759</td>\n","      <td>-1.071759</td>\n","      <td>0.422302</td>\n","      <td>5.500000</td>\n","      <td>84.074</td>\n","      <td>80.042</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>CCCCC(S)C</td>\n","      <td>126.15</td>\n","      <td>4.232083</td>\n","      <td>4.232083</td>\n","      <td>0.597176</td>\n","      <td>0.597176</td>\n","      <td>0.540734</td>\n","      <td>14.142857</td>\n","      <td>118.245</td>\n","      <td>104.133</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28803</th>\n","      <td>OCC(c1ccc2c(c1)ccc(OC)c2)C</td>\n","      <td>360.15</td>\n","      <td>12.412307</td>\n","      <td>12.412307</td>\n","      <td>0.064063</td>\n","      <td>-0.614534</td>\n","      <td>0.747626</td>\n","      <td>12.217391</td>\n","      <td>308.333</td>\n","      <td>292.205</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>28804</th>\n","      <td>O=C(OCC(c1ccc2c(c1)ccc(OC)c2)C)C</td>\n","      <td>334.15</td>\n","      <td>5.777407</td>\n","      <td>5.777407</td>\n","      <td>0.978519</td>\n","      <td>0.978519</td>\n","      <td>0.517522</td>\n","      <td>12.571429</td>\n","      <td>182.222</td>\n","      <td>172.142</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>28805</th>\n","      <td>c1cc(cnc1)C(=O)O</td>\n","      <td>509.75</td>\n","      <td>5.777407</td>\n","      <td>5.777407</td>\n","      <td>0.978519</td>\n","      <td>0.978519</td>\n","      <td>0.517522</td>\n","      <td>12.571429</td>\n","      <td>182.222</td>\n","      <td>172.142</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>28806</th>\n","      <td>C1=CC(=CN=C1)C(=O)O</td>\n","      <td>509.75</td>\n","      <td>5.777407</td>\n","      <td>5.777407</td>\n","      <td>0.978519</td>\n","      <td>0.978519</td>\n","      <td>0.517522</td>\n","      <td>12.571429</td>\n","      <td>182.222</td>\n","      <td>172.142</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>28807</th>\n","      <td>O=C(OC)\\C1=C(\\N/C(=C(/C(=O)OC)C1c2ccccc2[N+]([...</td>\n","      <td>446.15</td>\n","      <td>7.729444</td>\n","      <td>7.729444</td>\n","      <td>1.430556</td>\n","      <td>1.430556</td>\n","      <td>0.388843</td>\n","      <td>8.000000</td>\n","      <td>67.091</td>\n","      <td>62.051</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28808 rows × 4482 columns</p>\n","</div>"],"text/plain":["                                                  SMILES      Tm  \\\n","0                                  FC1=C(F)C(F)(F)C1(F)F  213.15   \n","1                            c1ccc2c(c1)ccc3Nc4ccccc4c23  407.15   \n","2                                    CCN1C(C)=Nc2ccccc12  324.15   \n","3                                             CC#CC(=O)O  351.15   \n","4                                              CCCCC(S)C  126.15   \n","...                                                  ...     ...   \n","28803                         OCC(c1ccc2c(c1)ccc(OC)c2)C  360.15   \n","28804                   O=C(OCC(c1ccc2c(c1)ccc(OC)c2)C)C  334.15   \n","28805                                   c1cc(cnc1)C(=O)O  509.75   \n","28806                                C1=CC(=CN=C1)C(=O)O  509.75   \n","28807  O=C(OC)\\C1=C(\\N/C(=C(/C(=O)OC)C1c2ccccc2[N+]([...  446.15   \n","\n","       MaxAbsEStateIndex  MaxEStateIndex  MinAbsEStateIndex  MinEStateIndex  \\\n","0              11.537037       11.537037           2.668981       -4.947338   \n","1               3.470111        3.470111           1.207271        1.207271   \n","2               4.446898        4.446898           0.992407        0.992407   \n","3               9.425694        9.425694           1.071759       -1.071759   \n","4               4.232083        4.232083           0.597176        0.597176   \n","...                  ...             ...                ...             ...   \n","28803          12.412307       12.412307           0.064063       -0.614534   \n","28804           5.777407        5.777407           0.978519        0.978519   \n","28805           5.777407        5.777407           0.978519        0.978519   \n","28806           5.777407        5.777407           0.978519        0.978519   \n","28807           7.729444        7.729444           1.430556        1.430556   \n","\n","            qed        SPS    MolWt  HeavyAtomMolWt  ...  RDKIT_2038  \\\n","0      0.479530  28.200000  162.032         162.032  ...         0.0   \n","1      0.446879  11.529412  217.271         206.183  ...         0.0   \n","2      0.625839  10.833333  160.220         148.124  ...         1.0   \n","3      0.422302   5.500000   84.074          80.042  ...         0.0   \n","4      0.540734  14.142857  118.245         104.133  ...         0.0   \n","...         ...        ...      ...             ...  ...         ...   \n","28803  0.747626  12.217391  308.333         292.205  ...         0.0   \n","28804  0.517522  12.571429  182.222         172.142  ...         0.0   \n","28805  0.517522  12.571429  182.222         172.142  ...         0.0   \n","28806  0.517522  12.571429  182.222         172.142  ...         0.0   \n","28807  0.388843   8.000000   67.091          62.051  ...         0.0   \n","\n","       RDKIT_2039  RDKIT_2040  RDKIT_2041  RDKIT_2042  RDKIT_2043  RDKIT_2044  \\\n","0             0.0         0.0         0.0         1.0         0.0         0.0   \n","1             0.0         0.0         1.0         0.0         0.0         0.0   \n","2             0.0         0.0         1.0         0.0         0.0         0.0   \n","3             0.0         0.0         0.0         0.0         0.0         0.0   \n","4             0.0         0.0         0.0         0.0         0.0         0.0   \n","...           ...         ...         ...         ...         ...         ...   \n","28803         0.0         0.0         0.0         0.0         0.0         0.0   \n","28804         0.0         0.0         0.0         0.0         0.0         0.0   \n","28805         0.0         0.0         1.0         0.0         0.0         0.0   \n","28806         0.0         0.0         1.0         0.0         0.0         0.0   \n","28807         1.0         0.0         0.0         1.0         0.0         0.0   \n","\n","       RDKIT_2045  RDKIT_2046  RDKIT_2047  \n","0             1.0         0.0         0.0  \n","1             0.0         0.0         0.0  \n","2             0.0         0.0         0.0  \n","3             0.0         0.0         0.0  \n","4             0.0         0.0         0.0  \n","...           ...         ...         ...  \n","28803         0.0         0.0         0.0  \n","28804         0.0         0.0         0.0  \n","28805         0.0         0.0         0.0  \n","28806         0.0         0.0         0.0  \n","28807         1.0         0.0         1.0  \n","\n","[28808 rows x 4482 columns]"]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["def extract_all_fingerprint(df, SMILES, morgan_radius = 2, morgan_nbits = 1024):\n","\n","    fps_data = []  # --> STORE NEW FEATURES DATA\n","\n","    # DEFINE MORGAN GENERATOR\n","    morgan_gen = rdFingerprintGenerator.GetMorganGenerator(radius = morgan_radius, fpSize = morgan_nbits, countSimulation = True, includeChirality = False)\n","\n","    fcfp = rdFingerprintGenerator.GetMorganFeatureAtomInvGen()\n","    fcfp_gen = rdFingerprintGenerator.GetMorganGenerator(radius = morgan_nbits, fpSize = morgan_nbits, atomInvariantsGenerator = fcfp, countSimulation= True, includeChirality = False)\n","\n","    atom_gen = rdFingerprintGenerator.GetAtomPairGenerator(fpSize = 2048, countSimulation= True, includeChirality = False)\n","\n","    # ITERATE EVERY SAMPLE OF SMILES FEATURES\n","    for smiles in df[SMILES]:\n","        mol = Chem.MolFromSmiles(smiles)\n","\n","        if mol is None:\n","            print(smiles, 'is Invalid!')\n","            fps_data.append({})\n","            continue\n","\n","        # STORE NEW FEATURE FOR EACH SAMPLES CREATED\n","        feature_rows = {}\n","\n","        # MORGAN FINGERPRINT (ECFP)\n","        morgan_fp = morgan_gen.GetFingerprint(mol)\n","        for i in range(morgan_nbits):\n","            feature_rows[f\"Morgan_{i}\"] = morgan_fp[i]\n","\n","        # FUNCTIONAL-CLASS FINGERPRINT (FCFP)\n","        fc_fp = fcfp_gen.GetFingerprint(mol)\n","        for i in range(morgan_nbits):\n","            feature_rows[f\"FCFP_{i}\"] = fc_fp[i]\n","\n","        # MACCS KEYS (166 BITS)\n","        maccs_fp = MACCSkeys.GenMACCSKeys(mol)\n","        for i in range(len(maccs_fp)):\n","            feature_rows[f\"MACCS_{i}\"] = int(maccs_fp[i])\n","\n","       \n","\n","        # RDKIT FINGERPRINT\n","        rdkit_fp = RDKFingerprint(mol)\n","        for i in range(len(rdkit_fp)):\n","            feature_rows[f\"RDKIT_{i}\"] = int(rdkit_fp[i])\n","\n","       \n","\n","\n","        fps_data.append(feature_rows)\n","\n","    print(f'There are {morgan_nbits} Morgan Fingerprint Features')\n","    print(f'There are {len(maccs_fp)} MACCS Keys Features')\n","    print(f'There are {len(rdkit_fp)} RDKIT Fingerprint Features')\n","\n","    # MERGE REAL DATA WITH EXTRACTED FEATURES\n","    fps_df = pd.DataFrame(fps_data)\n","    df_result = pd.concat((df, fps_df), axis = 1)\n","\n","    return df_result\n","\n","\n","# APPLY FUNCTION\n","merge = extract_all_fingerprint(merge, 'SMILES')\n","test  = extract_all_fingerprint(test, 'SMILES')\n","\n","merge"]},{"cell_type":"markdown","id":"504418da","metadata":{"papermill":{"duration":0.01074,"end_time":"2025-11-08T14:08:19.880671","exception":false,"start_time":"2025-11-08T14:08:19.869931","status":"completed"},"tags":[]},"source":["**A molecular fingerprint is a way to represent a complex chemical structure as a simple list of numbers (a vector), making it easy for a computer to search, compare, and build machine learning models.** Using a generator is the modern and efficient way to do this in RDKit. Instead of re-typing the settings for every molecule, you create one generator object that holds your \"recipe\" for making fingerprints. This ensures consistency and is faster when you're processing a large dataset.\n","****There are 1024 Morgan Fingerprint Features\n","There are 167 MACCS Keys Features\n","There are 2048 RDKIT Fingerprint Features****"]},{"cell_type":"code","execution_count":11,"id":"8d09b2f7","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:08:19.903272Z","iopub.status.busy":"2025-11-08T14:08:19.903035Z","iopub.status.idle":"2025-11-08T14:08:20.11992Z","shell.execute_reply":"2025-11-08T14:08:20.119216Z"},"papermill":{"duration":0.229958,"end_time":"2025-11-08T14:08:20.121104","exception":false,"start_time":"2025-11-08T14:08:19.891146","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["((28808, 4480), (28808,), (666, 4480), pandas.core.frame.DataFrame)"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["# splitting the training and testing data \n","x  = merge.drop(labels = ['SMILES', 'Tm'], axis = 1)\n","\n","y = merge['Tm']\n","\n","x_test = test.drop(labels = ['SMILES', 'id'], axis = 1)\n","\n","x.shape, y.shape, x_test.shape, type(x)"]},{"cell_type":"markdown","id":"16f2f71d","metadata":{"papermill":{"duration":0.010374,"end_time":"2025-11-08T14:08:20.14253","exception":false,"start_time":"2025-11-08T14:08:20.132156","status":"completed"},"tags":[]},"source":["-> verbosity: 0 - controls the amount of logging XGBoost does\n","-> objective - defines the type of problem(what the learns to minimize).\n","'reg:squarederror'- minimizes mean squared error, 'reg:pseudohubererror- a robust loss'\n","->tree-method - gpu_hist -> uses gpu for histogram-based tree building \n","->predictor- ensures predictions run on GPU \n","-> devices: cuda \n","-> booster: 'gbtree' - defines the type of base model XGbost uses\n"]},{"cell_type":"code","execution_count":12,"id":"261546b1","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:08:20.16432Z","iopub.status.busy":"2025-11-08T14:08:20.164081Z","iopub.status.idle":"2025-11-08T14:08:20.173135Z","shell.execute_reply":"2025-11-08T14:08:20.172171Z"},"papermill":{"duration":0.021349,"end_time":"2025-11-08T14:08:20.174294","exception":false,"start_time":"2025-11-08T14:08:20.152945","status":"completed"},"tags":[]},"outputs":[],"source":["def objective(trial):\n","    xgb_params = {\n","        \"verbosity\": 0, \n","        \"objective\": trial.suggest_categorical(\"objective\", ['reg:squarederror', 'reg:pseudohubererror']),\n","        \"tree_method\": \"gpu_hist\",\n","        'predictor' : 'gpu_predictor',\n","        'device' : 'cuda',\n","        \"eval_metric\": \"rmse\",\n","        \"booster\": \"gbtree\",\n","        'n_estimators' : 10_000,\n","        \"max_depth\": trial.suggest_int(\"max_depth\", 3, 7),\n","        \"learning_rate\": trial.suggest_float(\"learning_rate\", 3e-3, 0.3, log=True),\n","        \"min_child_weight\": trial.suggest_int(\"min_child_weight\", 1, 10),\n","        \"subsample\": trial.suggest_float(\"subsample\", 0.5, 1.0),\n","        \"colsample_bytree\": trial.suggest_float(\"colsample_bytree\", 0.5, 1.0),\n","        \"gamma\": trial.suggest_float(\"gamma\", 0, 5),\n","        \"lambda\": trial.suggest_float(\"lambda\", 0.1, 20.0, log=True),\n","        \"alpha\": trial.suggest_float(\"alpha\", 0.1, 20.0, log=True),\n","    }\n","\n","\n","    kfold = KFold(n_splits= 5 , shuffle =True, random_state = 2000)\n","    rmse_scores = []\n","\n","    for train_idx, valid_idx in kf.split(x):\n","        X_train , X_valid = x.iloc[train_idx], x.iloc[valid_idx]\n","        y_train, y_valid = y[train_idx], y[valid_idx]\n","\n","\n","        dtrain = xgboost.DMatrix(X_train, label = y_train)\n","        dvalid = xgboost.DMatrix(X_valid, label = y_valid)\n","\n","        model = xgboost.train(\n","            xgb_params,\n","            dtrain, \n","            num_boost_round = 10000,\n","            evals= [(dvalid, \"validation\")],\n","            early_stopping_rounds = 100,\n","            verbose_eval = False,\n","        )\n","        pred = model.predict(dvalid)\n","        rmse = mean_squared_error(y_valid, pred, squared =False)\n","        rmse_scores.appen(rmse)\n","\n","    return np.mean(rmse_scores)"]},{"cell_type":"code","execution_count":13,"id":"28c24029","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:08:20.196612Z","iopub.status.busy":"2025-11-08T14:08:20.196049Z","iopub.status.idle":"2025-11-08T14:08:21.74085Z","shell.execute_reply":"2025-11-08T14:08:21.740119Z"},"papermill":{"duration":1.556909,"end_time":"2025-11-08T14:08:21.741909","exception":false,"start_time":"2025-11-08T14:08:20.185","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Training Complete! Congrats!\n","Total Number of Trials : 84\n","\n","Best Trial 64\n","Best MAE: 0.44985248490081825\n","Best Params: {'objective': 'reg:squarederror', 'max_depth': 3, 'learning_rate': 0.01688021212211354, 'min_child_weight': 5, 'subsample': 0.8943127227676447, 'colsample_bytree': 0.590582609011384, 'gamma': 0.01132850232872052, 'lambda': 4.445806747037075, 'alpha': 0.1292033669407927}\n"]}],"source":["# start optuna to finding the best parameters for our models \n","shutil.copy(src = '/kaggle/input/optuna-study-3-models/other/optuna-study-3-models/3/xgb_study.db', dst = '/kaggle/working/xgb_study.db')\n","study = optuna.create_study(direction = \"minimize\", study_name = 'xgb_study', storage=\"sqlite://////kaggle/working/xgb_study.db\", load_if_exists = True)\n","\n","clear_output(wait=True)\n","\n","print(f'Training Complete! Congrats!')\n","print(f'Total Number of Trials : {len(study.trials)}\\n')\n","\n","print(\"Best Trial\", study.best_trial.number)\n","print(\"Best MAE:\", study.best_value)\n","print(\"Best Params:\", study.best_trial.params)"]},{"cell_type":"code","execution_count":14,"id":"f7409a0f","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:08:21.764763Z","iopub.status.busy":"2025-11-08T14:08:21.764285Z","iopub.status.idle":"2025-11-08T14:08:21.768837Z","shell.execute_reply":"2025-11-08T14:08:21.768266Z"},"papermill":{"duration":0.017008,"end_time":"2025-11-08T14:08:21.769884","exception":false,"start_time":"2025-11-08T14:08:21.752876","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["{'max_depth': 6, 'eta': 0.1, 'tree_method': 'hist', 'eval_metric': 'mae'}"]},"execution_count":14,"metadata":{},"output_type":"execute_result"}],"source":["best_params = {\n","    'max_depth' : 6,\n","    'eta' : 0.1,\n","    'tree_method' : 'hist',\n","    'eval_metric' : 'mae'\n","}\n","\n","best_params"]},{"cell_type":"code","execution_count":15,"id":"c36bd3d1","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:08:21.792113Z","iopub.status.busy":"2025-11-08T14:08:21.791679Z","iopub.status.idle":"2025-11-08T14:08:21.795883Z","shell.execute_reply":"2025-11-08T14:08:21.795336Z"},"papermill":{"duration":0.016327,"end_time":"2025-11-08T14:08:21.796913","exception":false,"start_time":"2025-11-08T14:08:21.780586","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["\"{'objective': 'reg:squarederror',\\n 'max_depth': 3,\\n 'learning_rate': 0.01688021212211354,\\n 'min_child_weight': 5,\\n 'subsample': 0.8943127227676447,\\n 'colsample_bytree': 0.590582609011384,\\n 'gamma': 0.01132850232872052,\\n 'lambda': 4.445806747037075,\\n 'alpha': 0.1292033669407927,\\n 'eval_metric': 'mae',\\n 'device': 'cpu'}\""]},"execution_count":15,"metadata":{},"output_type":"execute_result"}],"source":["'''{'objective': 'reg:squarederror',\n"," 'max_depth': 3,\n"," 'learning_rate': 0.01688021212211354,\n"," 'min_child_weight': 5,\n"," 'subsample': 0.8943127227676447,\n"," 'colsample_bytree': 0.590582609011384,\n"," 'gamma': 0.01132850232872052,\n"," 'lambda': 4.445806747037075,\n"," 'alpha': 0.1292033669407927,\n"," 'eval_metric': 'mae',\n"," 'device': 'cpu'}'''"]},{"cell_type":"code","execution_count":16,"id":"e56463bd","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:08:21.819543Z","iopub.status.busy":"2025-11-08T14:08:21.819102Z","iopub.status.idle":"2025-11-08T14:08:21.82212Z","shell.execute_reply":"2025-11-08T14:08:21.821615Z"},"papermill":{"duration":0.015251,"end_time":"2025-11-08T14:08:21.823011","exception":false,"start_time":"2025-11-08T14:08:21.80776","status":"completed"},"tags":[]},"outputs":[],"source":["best_params.update({\n","    'n_estimators': 10_000,\n","    'tree_method': 'gpu_hist',\n","    'predictor': 'gpu_predictor',\n","    'device': 'cuda',\n","    'eval_metric': 'mae'  # since your best metric was MAE\n","})"]},{"cell_type":"code","execution_count":17,"id":"b5a626a1","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:08:21.845231Z","iopub.status.busy":"2025-11-08T14:08:21.84506Z","iopub.status.idle":"2025-11-08T14:08:22.139458Z","shell.execute_reply":"2025-11-08T14:08:22.138826Z"},"papermill":{"duration":0.30689,"end_time":"2025-11-08T14:08:22.140799","exception":false,"start_time":"2025-11-08T14:08:21.833909","status":"completed"},"tags":[]},"outputs":[],"source":["X_train = merge.drop(columns=['SMILES', 'Tm'])\n","y_train = merge['Tm']\n","X_test = test.drop(columns=['SMILES'], errors='ignore')"]},{"cell_type":"code","execution_count":18,"id":"174a290f","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:08:22.163619Z","iopub.status.busy":"2025-11-08T14:08:22.163401Z","iopub.status.idle":"2025-11-08T14:13:55.509692Z","shell.execute_reply":"2025-11-08T14:13:55.508961Z"},"papermill":{"duration":333.37031,"end_time":"2025-11-08T14:13:55.522323","exception":false,"start_time":"2025-11-08T14:08:22.152013","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:08:32] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n"]},{"data":{"text/html":["<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>XGBRegressor(base_score=None, booster=None, callbacks=None,\n","             colsample_bylevel=None, colsample_bynode=None,\n","             colsample_bytree=None, device=&#x27;cuda&#x27;, early_stopping_rounds=None,\n","             enable_categorical=False, eta=0.1, eval_metric=&#x27;mae&#x27;,\n","             feature_types=None, gamma=None, grow_policy=None,\n","             importance_type=None, interaction_constraints=None,\n","             learning_rate=None, max_bin=None, max_cat_threshold=None,\n","             max_cat_to_onehot=None, max_delta_step=None, max_depth=6,\n","             max_leaves=None, min_child_weight=None, missing=nan,\n","             monotone_constraints=None, multi_strategy=None, n_estimators=10000,\n","             n_jobs=None, num_parallel_tree=None, ...)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">XGBRegressor</label><div class=\"sk-toggleable__content\"><pre>XGBRegressor(base_score=None, booster=None, callbacks=None,\n","             colsample_bylevel=None, colsample_bynode=None,\n","             colsample_bytree=None, device=&#x27;cuda&#x27;, early_stopping_rounds=None,\n","             enable_categorical=False, eta=0.1, eval_metric=&#x27;mae&#x27;,\n","             feature_types=None, gamma=None, grow_policy=None,\n","             importance_type=None, interaction_constraints=None,\n","             learning_rate=None, max_bin=None, max_cat_threshold=None,\n","             max_cat_to_onehot=None, max_delta_step=None, max_depth=6,\n","             max_leaves=None, min_child_weight=None, missing=nan,\n","             monotone_constraints=None, multi_strategy=None, n_estimators=10000,\n","             n_jobs=None, num_parallel_tree=None, ...)</pre></div></div></div></div></div>"],"text/plain":["XGBRegressor(base_score=None, booster=None, callbacks=None,\n","             colsample_bylevel=None, colsample_bynode=None,\n","             colsample_bytree=None, device='cuda', early_stopping_rounds=None,\n","             enable_categorical=False, eta=0.1, eval_metric='mae',\n","             feature_types=None, gamma=None, grow_policy=None,\n","             importance_type=None, interaction_constraints=None,\n","             learning_rate=None, max_bin=None, max_cat_threshold=None,\n","             max_cat_to_onehot=None, max_delta_step=None, max_depth=6,\n","             max_leaves=None, min_child_weight=None, missing=nan,\n","             monotone_constraints=None, multi_strategy=None, n_estimators=10000,\n","             n_jobs=None, num_parallel_tree=None, ...)"]},"execution_count":18,"metadata":{},"output_type":"execute_result"}],"source":["import xgboost as xgb\n","best_params.pop(\"predictor\",None)\n","final_model = xgb.XGBRegressor(**best_params)\n","\n","final_model.fit(\n","    X_train, y_train,\n","    eval_set=[(X_train, y_train)],\n","    verbose=False\n",")"]},{"cell_type":"code","execution_count":19,"id":"65659205","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:13:55.545004Z","iopub.status.busy":"2025-11-08T14:13:55.544812Z","iopub.status.idle":"2025-11-08T14:13:55.54932Z","shell.execute_reply":"2025-11-08T14:13:55.548797Z"},"papermill":{"duration":0.017089,"end_time":"2025-11-08T14:13:55.550364","exception":false,"start_time":"2025-11-08T14:13:55.533275","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["(28808, 4480)"]},"execution_count":19,"metadata":{},"output_type":"execute_result"}],"source":["X_train.shape"]},{"cell_type":"code","execution_count":20,"id":"be44444f","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:13:55.573153Z","iopub.status.busy":"2025-11-08T14:13:55.57297Z","iopub.status.idle":"2025-11-08T14:13:55.576161Z","shell.execute_reply":"2025-11-08T14:13:55.575486Z"},"papermill":{"duration":0.015813,"end_time":"2025-11-08T14:13:55.577259","exception":false,"start_time":"2025-11-08T14:13:55.561446","status":"completed"},"tags":[]},"outputs":[],"source":["# X_test = X_test.drop(columns = ['id'])"]},{"cell_type":"code","execution_count":21,"id":"c55ed661","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:13:55.600147Z","iopub.status.busy":"2025-11-08T14:13:55.599645Z","iopub.status.idle":"2025-11-08T14:13:55.60354Z","shell.execute_reply":"2025-11-08T14:13:55.602822Z"},"papermill":{"duration":0.016589,"end_time":"2025-11-08T14:13:55.604678","exception":false,"start_time":"2025-11-08T14:13:55.588089","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["(666, 4481) (28808, 4480)\n"]}],"source":["print(X_test.shape, X_train.shape)"]},{"cell_type":"code","execution_count":22,"id":"cce99e44","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:13:55.627331Z","iopub.status.busy":"2025-11-08T14:13:55.627162Z","iopub.status.idle":"2025-11-08T14:13:55.633627Z","shell.execute_reply":"2025-11-08T14:13:55.632964Z"},"papermill":{"duration":0.018938,"end_time":"2025-11-08T14:13:55.634594","exception":false,"start_time":"2025-11-08T14:13:55.615656","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Extra columns in X_test: {'id'}\n","Missing columns in X_test: set()\n"]}],"source":["print(\"Extra columns in X_test:\", set(X_test.columns) - set(X_train.columns))\n","print(\"Missing columns in X_test:\", set(X_train.columns) - set(X_test.columns))"]},{"cell_type":"code","execution_count":23,"id":"a6ae080c","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:13:55.65762Z","iopub.status.busy":"2025-11-08T14:13:55.657442Z","iopub.status.idle":"2025-11-08T14:13:55.666329Z","shell.execute_reply":"2025-11-08T14:13:55.665809Z"},"papermill":{"duration":0.021969,"end_time":"2025-11-08T14:13:55.667523","exception":false,"start_time":"2025-11-08T14:13:55.645554","status":"completed"},"tags":[]},"outputs":[],"source":["X_test = X_test.drop(columns=[\"id\"])"]},{"cell_type":"code","execution_count":24,"id":"10e633f6","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:13:55.691844Z","iopub.status.busy":"2025-11-08T14:13:55.691648Z","iopub.status.idle":"2025-11-08T14:13:55.695028Z","shell.execute_reply":"2025-11-08T14:13:55.694357Z"},"papermill":{"duration":0.017148,"end_time":"2025-11-08T14:13:55.696045","exception":false,"start_time":"2025-11-08T14:13:55.678897","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["(666, 4480)\n"]}],"source":["print(X_test.shape)"]},{"cell_type":"code","execution_count":25,"id":"35122857","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:13:55.719015Z","iopub.status.busy":"2025-11-08T14:13:55.718812Z","iopub.status.idle":"2025-11-08T14:13:56.079568Z","shell.execute_reply":"2025-11-08T14:13:56.078757Z"},"papermill":{"duration":0.373654,"end_time":"2025-11-08T14:13:56.08093","exception":false,"start_time":"2025-11-08T14:13:55.707276","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:13:55] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n","/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:13:55] WARNING: /workspace/src/common/error_msg.cc:58: Falling back to prediction using DMatrix due to mismatched devices. This might lead to higher memory usage and slower performance. XGBoost is running on: cuda:0, while the input data is on: cpu.\n","Potential solutions:\n","- Use a data structure that matches the device ordinal in the booster.\n","- Set the device for booster before call to inplace_predict.\n","\n","This warning will only be shown once.\n","\n","\n"]}],"source":["y_pred = final_model.predict(X_test.to_numpy())"]},{"cell_type":"code","execution_count":26,"id":"65921473","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:13:56.105054Z","iopub.status.busy":"2025-11-08T14:13:56.104829Z","iopub.status.idle":"2025-11-08T14:14:00.062554Z","shell.execute_reply":"2025-11-08T14:14:00.061921Z"},"papermill":{"duration":3.970828,"end_time":"2025-11-08T14:14:00.063907","exception":false,"start_time":"2025-11-08T14:13:56.093079","status":"completed"},"tags":[]},"outputs":[],"source":["y_pred2 = final_model.predict(X_train)"]},{"cell_type":"code","execution_count":27,"id":"3ad50dce","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:14:00.087956Z","iopub.status.busy":"2025-11-08T14:14:00.087524Z","iopub.status.idle":"2025-11-08T14:14:00.139018Z","shell.execute_reply":"2025-11-08T14:14:00.138137Z"},"papermill":{"duration":0.064451,"end_time":"2025-11-08T14:14:00.140115","exception":false,"start_time":"2025-11-08T14:14:00.075664","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["MSE: 53.2059859197144\n","MAE: 0.6210584590184094\n","R2: 0.9945139637174777\n"]}],"source":["from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score\n","\n","print(\"MSE:\", mean_squared_error(y_train, y_pred2))\n","print(\"MAE:\", mean_absolute_error(y_train, y_pred2))\n","print(\"R2:\", r2_score(y_train, y_pred2))"]},{"cell_type":"code","execution_count":28,"id":"0714b0a7","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:14:00.163651Z","iopub.status.busy":"2025-11-08T14:14:00.16343Z","iopub.status.idle":"2025-11-08T14:34:42.786609Z","shell.execute_reply":"2025-11-08T14:34:42.785758Z"},"papermill":{"duration":1242.636277,"end_time":"2025-11-08T14:34:42.78788","exception":false,"start_time":"2025-11-08T14:14:00.151603","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:14:09] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n","/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:18:04] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n","/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:18:19] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n","/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:22:13] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n","/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:22:23] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n","/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:26:17] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n","/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:26:27] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n","/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:30:31] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n","/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:30:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n","/usr/local/lib/python3.11/dist-packages/xgboost/core.py:160: UserWarning:\n","\n","[14:34:41] WARNING: /workspace/src/common/error_msg.cc:27: The tree method `gpu_hist` is deprecated since 2.0.0. To use GPU training, set the `device` parameter to CUDA instead.\n","\n","    E.g. tree_method = \"hist\", device = \"cuda\"\n","\n","\n"]},{"name":"stdout","output_type":"stream","text":["Cross-validated RMSE: 42.668069015422915\n"]}],"source":["from sklearn.model_selection import cross_val_score\n","\n","# Use negative MSE because cross_val_score always maximizes the score\n","cv_scores = cross_val_score(final_model, X_train, y_train, cv=5, scoring='neg_mean_squared_error')\n","cv_rmse = np.sqrt(-cv_scores)\n","print(\"Cross-validated RMSE:\", cv_rmse.mean())"]},{"cell_type":"code","execution_count":29,"id":"eb3df432","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:34:42.8134Z","iopub.status.busy":"2025-11-08T14:34:42.812883Z","iopub.status.idle":"2025-11-08T14:34:42.821013Z","shell.execute_reply":"2025-11-08T14:34:42.820335Z"},"papermill":{"duration":0.021343,"end_time":"2025-11-08T14:34:42.82203","exception":false,"start_time":"2025-11-08T14:34:42.800687","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["0.0226287841796875\n","281.0001586914062\n","0.9945139637433017\n"]}],"source":["from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score, median_absolute_error, max_error, explained_variance_score\n","\n","median_err = median_absolute_error(y_train, y_pred2)\n","max_err = max_error(y_train, y_pred2)\n","expl_var = explained_variance_score(y_train, y_pred2)\n","\n","print(median_err)\n","print(max_err)\n","print(expl_var)"]},{"cell_type":"code","execution_count":30,"id":"ca871ade","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:34:42.846572Z","iopub.status.busy":"2025-11-08T14:34:42.846044Z","iopub.status.idle":"2025-11-08T14:34:42.866979Z","shell.execute_reply":"2025-11-08T14:34:42.86641Z"},"papermill":{"duration":0.034101,"end_time":"2025-11-08T14:34:42.867992","exception":false,"start_time":"2025-11-08T14:34:42.833891","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Tm</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1022</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1146</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>79</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2279</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1342</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["     id  Tm\n","0  1022   0\n","1  1146   0\n","2    79   0\n","3  2279   0\n","4  1342   0"]},"execution_count":30,"metadata":{},"output_type":"execute_result"}],"source":["sample = pd.read_csv('/kaggle/input/melting-point/sample_submission.csv')\n","sample.head()"]},{"cell_type":"code","execution_count":31,"id":"2fc7a406","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:34:42.893654Z","iopub.status.busy":"2025-11-08T14:34:42.893421Z","iopub.status.idle":"2025-11-08T14:34:42.897193Z","shell.execute_reply":"2025-11-08T14:34:42.896659Z"},"papermill":{"duration":0.017283,"end_time":"2025-11-08T14:34:42.898222","exception":false,"start_time":"2025-11-08T14:34:42.880939","status":"completed"},"tags":[]},"outputs":[],"source":["assert len(sample) == len(y_pred)\n","\n","submission = pd.DataFrame({\n","    'id': sample['id'],   # match Kaggle's expected order\n","    'Tm': y_pred          # predicted target\n","})"]},{"cell_type":"code","execution_count":32,"id":"2d490888","metadata":{"execution":{"iopub.execute_input":"2025-11-08T14:34:42.923222Z","iopub.status.busy":"2025-11-08T14:34:42.923003Z","iopub.status.idle":"2025-11-08T14:34:42.932187Z","shell.execute_reply":"2025-11-08T14:34:42.931429Z"},"papermill":{"duration":0.023127,"end_time":"2025-11-08T14:34:42.933366","exception":false,"start_time":"2025-11-08T14:34:42.910239","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["✅ submission.csv created successfully!\n"]}],"source":["submission.to_csv('submission1234.csv', index=False)\n","print(\"✅ submission.csv created successfully!\")"]},{"cell_type":"code","execution_count":null,"id":"bdcf987d","metadata":{"papermill":{"duration":0.011923,"end_time":"2025-11-08T14:34:42.957354","exception":false,"start_time":"2025-11-08T14:34:42.945431","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kaggle":{"accelerator":"gpu","dataSources":[{"databundleVersionId":13473948,"sourceId":113155,"sourceType":"competition"},{"datasetId":8364474,"sourceId":13248875,"sourceType":"datasetVersion"},{"isSourceIdPinned":true,"modelId":456306,"modelInstanceId":439753,"sourceId":590904,"sourceType":"modelInstanceVersion"}],"dockerImageVersionId":31153,"isGpuEnabled":true,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.13"},"papermill":{"default_parameters":{},"duration":1920.795588,"end_time":"2025-11-08T14:34:44.288838","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-11-08T14:02:43.49325","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}